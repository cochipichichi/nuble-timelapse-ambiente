<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>🌊 Ríos y Cuencas — Ñuble</title>
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body class="fullscreen">
  <div class="toolbar">
    <div class="title">🌊 Ríos y Cuencas</div>
    <div class="controls">
      <a class="toggle" href="../index.html">↩️ Volver</a>
    </div>
  </div>
  <div class="mapwrap">
    <div id="map"></div>
  </div>

<script>
const map = L.map('map').setView([-36.7,-72.3], 8);
const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19, attribution:'© OpenStreetMap'}).addTo(map);

// Load GeoJSON
async function loadLayer(url, style, onEach){
  const res = await fetch(url); const gj = await res.json();
  return L.geoJSON(gj,{style, onEachFeature:onEach}).addTo(map);
}
function styleCuencas(){ return {color:'#3fd37a', weight:2, fillOpacity:0.08}; }
function onEach(f, layer){ if(f.properties && f.properties.name){ layer.bindPopup(`<b>${f.properties.name}</b>`); } }

loadLayer('../data/cuencas_itata_nuble.geojson', styleCuencas(), onEach);

fetch('../data/estaciones_caudal.geojson').then(r=>r.json()).then(gj=>{
  L.geoJSON(gj,{
    pointToLayer:(f,latlng)=> L.circleMarker(latlng,{radius:6, color:'#5bd6ff', fillColor:'#5bd6ff', fillOpacity:.9, weight:2}),
    onEachFeature:(f,l)=> l.bindPopup(`<b>${f.properties.estacion}</b><br>${f.properties.param}`)
  }).addTo(map);
});

</script>
</body>
</html>
